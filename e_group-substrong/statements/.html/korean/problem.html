<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META content="no-cache" http-equiv="pragma">
    <META content="-1" http-equiv="expires">
    <META content="text/html;charset=UTF-8" http-equiv="content-type">
    <LINK href="problem-statement.css" rel="stylesheet" type="text/css">
    <TITLE>그룹 부분 문자열과 쿼리</TITLE>
    <SCRIPT type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
        });
        </SCRIPT>
        <SCRIPT async="" src="https://polygon.codeforces.com/lib/MathJax/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
    </SCRIPT>
</HEAD><BODY>
    <DIV class="problem-statement"><DIV class="header"><DIV class="title">그룹 부분 문자열과 쿼리</DIV><DIV class="time-limit"><DIV class="property-title">time limit per test</DIV>2 seconds</DIV><DIV class="memory-limit"><DIV class="property-title">memory limit per test</DIV>1024 megabytes</DIV><DIV class="input-file input-standard"><DIV class="property-title">input</DIV>standard input</DIV><DIV class="output-file output-standard"><DIV class="property-title">output</DIV>standard output</DIV></DIV><DIV class="legend"><P>'<SPAN class="tex-font-style-tt">0</SPAN>'과 '<SPAN class="tex-font-style-tt">1</SPAN>'만으로 이루어진 <SPAN class="tex-font-style-bf">길이 $$$1$$$ 이상의</SPAN> 문자열 $$$A$$$가 다음 조건 중 하나를 만족하는 경우, 이러한 $$$A$$$를 <SPAN class="tex-font-style-bf">그룹 문자열</SPAN>이라고 부릅니다.</P><P></P><UL> <LI> $$$A$$$에 '<SPAN class="tex-font-style-tt">0</SPAN>'이 등장하지 않거나 '<SPAN class="tex-font-style-tt">1</SPAN>'이 등장하지 않습니다. </LI><LI> $$$A$$$에서 모든 '<SPAN class="tex-font-style-tt">0</SPAN>'은 모든 '<SPAN class="tex-font-style-tt">1</SPAN>'보다 먼저 등장합니다. </LI><LI> $$$A$$$에서 모든 '<SPAN class="tex-font-style-tt">1</SPAN>'은 모든 '<SPAN class="tex-font-style-tt">0</SPAN>'보다 먼저 등장합니다. </LI></UL><P></P><P>예를 들어, "<SPAN class="tex-font-style-tt">000</SPAN>", "<SPAN class="tex-font-style-tt">11</SPAN>", "<SPAN class="tex-font-style-tt">00111</SPAN>", "<SPAN class="tex-font-style-tt">110</SPAN>"은 그룹 문자열이지만, "<SPAN class="tex-font-style-tt">1011</SPAN>"이나 "<SPAN class="tex-font-style-tt">00100</SPAN>"은 그룹 문자열이 아닙니다.</P><P>'<SPAN class="tex-font-style-tt">0</SPAN>'과 '<SPAN class="tex-font-style-tt">1</SPAN>'만으로 이루어진 문자열 $$$S$$$에 대해, $$$S$$$의 처음과 끝에서 문자를 원하는 만큼 지워 만들 수 있는 <SPAN class="tex-font-style-bf">서로 다른 그룹 문자열의 개수</SPAN>를 $$$f(S)$$$라고 정의합니다. 예를 들어, $$$S$$$가 "<SPAN class="tex-font-style-tt">10110</SPAN>"일 때 만들 수 있는 그룹 문자열은 "<SPAN class="tex-font-style-tt">0</SPAN>", "<SPAN class="tex-font-style-tt">01</SPAN>", "<SPAN class="tex-font-style-tt">011</SPAN>", "<SPAN class="tex-font-style-tt">1</SPAN>", "<SPAN class="tex-font-style-tt">10</SPAN>", "<SPAN class="tex-font-style-tt">11</SPAN>", "<SPAN class="tex-font-style-tt">110</SPAN>"이 있습니다. 그러므로 $$$S$$$가 "<SPAN class="tex-font-style-tt">10110</SPAN>"일 때 $$$f(S)$$$의 값은 $$$7$$$입니다. 이때 "<SPAN class="tex-font-style-tt">10</SPAN>"이 $$$S$$$에 <SPAN class="tex-font-style-bf">여러 번 등장하지만</SPAN> $$$f(S)$$$를 구하는 데는 <SPAN class="tex-font-style-bf">한 번만 세는 것</SPAN>에 유의하세요.</P><P>여러분에게 문자열 $$$X$$$에 대한 $$$Q$$$번의 질문이 주어집니다. 초기에 문자열 $$$X$$$는 빈 문자열입니다. 각 질문은 다음과 같은 형태입니다.</P><P></P><UL> <LI> $$$c$$$ $$$k$$$: 문자열 $$$X$$$의 끝에 문자 $$$c$$$를 $$$k$$$개 붙입니다. 그후 $$$f(X)$$$의 값을 구합니다. </LI></UL><P></P><P>이때 질문으로 문자열 $$$X$$$에 추가된 문자는 그다음 질문이 주어질 때에도 문자열 $$$X$$$에서 지워지지 않고 남아있습니다.</P><P>여러분은 각 질문에 대해 충분히 빨리 대답할 수 있을까요?</P></DIV><P></P><P></P><DIV class="input-specification"><DIV class="section-title">Input</DIV><P></P><P>첫 번째 줄에 정수 $$$Q$$$가 주어집니다.</P><P>두 번째 줄부터 $$$Q$$$개의 줄에 걸쳐 각 줄에 질문에 대응되는 문자 $$$c_i$$$와 양의 정수 $$$k_i$$$가 주어집니다.</P></DIV><P></P><P></P><DIV class="output-specification"><DIV class="section-title">Output</DIV><P></P><P>$$$Q$$$개의 줄에 걸쳐 각 줄에 질문에 대한 정답을 출력합니다.</P></DIV><P></P><P></P><DIV class="scoring"><DIV class="section-title">Scoring</DIV><P></P><P></P><UL> <LI> $$$1 \le Q \le 200\,000$$$ </LI><LI> 각 $$$1 \le i \le Q$$$에 대해 $$$c_i$$$는 '<SPAN class="tex-font-style-tt">0</SPAN>' 또는 '<SPAN class="tex-font-style-tt">1</SPAN>' </LI><LI> 각 $$$1 \le i \le Q$$$에 대한 $$$k_i$$$의 합은 $$$1\,000\,000\,000$$$ 이하 </LI></UL><P></P><P><SPAN class="tex-font-style-bf">서브태스크</SPAN></P><P><TABLE class="tex-tabular"><TBODY><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-bf">번호</SPAN></TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-bf">배점</SPAN></TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-bf">제한</SPAN></TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">11</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">각 $$$1 \le i \le Q$$$에 대한 $$$k_i$$$의 합은 $$$100$$$ 이하</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">23</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">각 $$$1 \le i \le Q$$$에 대한 $$$k_i$$$의 합은 $$$3000$$$ 이하</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">37</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">각 $$$1 \le i \le Q$$$에 대한 $$$k_i$$$의 합은 $$$1\,000\,000$$$ 이하</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">29</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">추가 제한 없음</TD></TR></TBODY></TABLE></P></DIV><P></P><P></P><DIV class="sample-tests"><DIV class="section-title">Example</DIV><P></P><P></P><DIV class="sample-test"><DIV class="input"><DIV class="title">Input</DIV><PRE class="content" data-content="6
1 1
0 1
1 2
0 1
1 2
1 2
">
<DIV class="test-example-line test-example-line-even test-example-line-0">6</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">0 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">0 1</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 2</DIV><DIV class="test-example-line test-example-line-even test-example-line-0">1 2</DIV></PRE></DIV><DIV class="output"><DIV class="title">Output</DIV><PRE class="content">
1
3
6
7
7
11
</PRE></DIV></DIV></DIV><P></P><P></P><DIV class="note"><DIV class="section-title">Note</DIV><P></P><P>예제의 각 질문에 대해 새로운 문자열 $$$X$$$의 내용, 새롭게 만들 수 있는 그룹 문자열, 그리고 $$$f(X)$$$의 값은 다음과 같습니다.</P><P><TABLE class="tex-tabular"><TBODY><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-bf">질문</SPAN></TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-bf">문자열 $$$X$$$</SPAN></TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-bf">새롭게 만들 수 있는 그룹 문자열</SPAN></TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$f(X)$$$</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-tt">1</SPAN> $$$1$$$</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">1</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">1</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$1$$$</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-tt">0</SPAN> $$$1$$$</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">10</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">0</SPAN>", "<SPAN class="tex-font-style-tt">10</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$3$$$</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-tt">1</SPAN> $$$2$$$</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">1011</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">01</SPAN>", "<SPAN class="tex-font-style-tt">011</SPAN>", "<SPAN class="tex-font-style-tt">11</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$6$$$</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-tt">0</SPAN> $$$1$$$</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">10110</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">110</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$7$$$</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-tt">1</SPAN> $$$2$$$</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">1011011</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">없음</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$7$$$</TD></TR><TR><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><SPAN class="tex-font-style-tt">1</SPAN> $$$2$$$</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">101101111</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">"<SPAN class="tex-font-style-tt">0111</SPAN>", "<SPAN class="tex-font-style-tt">01111</SPAN>", "<SPAN class="tex-font-style-tt">111</SPAN>", "<SPAN class="tex-font-style-tt">1111</SPAN>"</TD><TD class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$$$11$$$</TD></TR></TBODY></TABLE></P></DIV></DIV><P></P><P>  </P>

</BODY></HTML>